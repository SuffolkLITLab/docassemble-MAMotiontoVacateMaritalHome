---
features:
  question help button: True
---
include:
  - docassemble.AssemblyLine:al_package.yml
  - docassemble.MassAccess:massaccess.yml
---
mandatory: True
code: |
  interview_metadata # make sure we initialize the object
  if not defined( "interview_metadata['MAMotionToVacateMaritalHome']"):
    interview_metadata.initializeObject('MAMotionToVacateMaritalHome')
  interview_metadata['MAMotionToVacateMaritalHome'].update({
    'title': 'Motion To Vacate Marital Home',
    'short title': 'Motion to Vacate Home',
    'description': 'An interview to ask the court to order the other side in your family law case to leave your home',
    'original_form': '',
    'allowed courts': [
      'Probate and Family Court'
    ],
    'preferred court': 'Probate and Family Court',
    'categories': [],
    'logic block variable': '',
    'attachment block variable': '',  })
---
metadata:
  title: |
    Motion to Vacate Home
  tags: |
    - Family
  description: |
    An interview to ask the court to order the other side in your family law case to leave your home 
  authors:
    - Kate Barry
---
code: |
  github_repo_name = "docassemble-MAMotiontoVacateMaritalHome"
---
code: |
  interview_short_title = "Ask the court to tell someone to leave your home"
---
code: |
  allowed_courts = ["Probate and Family Court"]
---
objects:
  opposing_counsel: ALIndividual
  vacate_address: ALAddress
  docket_number: DAList.using(ask_number=True)
---
comment: |
  ## Mandatory block that determines interview order.
mandatory: True
code: |
  form_approved_for_email_filing = False
  basic_questions_intro_screen 
  intro_screen_seen
  users[0].name.first
  other_parties.ask_number=True
  other_parties.target_number=1
  other_parties[0].name.first
  if not married_to_opposing_party and not joint_children:
    cannot_complete_interview
  if not prerequisites:
    cannot_complete_interview
  vacate_address.address
  users[0].mobile_number
  user_needs_interpreter
  if who_lives_at_vacate_address.all_true():
    ever_lived_together = True
    parties_live_together_now = True
    reasons_for_leaving = DAEmpty()
    parties_lived_at_vacate_address = True
  if who_lives_at_vacate_address.all_false():
    cannot_complete_interview 
  if who_lives_at_vacate_address.any_false('user', 'opposing party'):
    parties_live_together_now = False
    if not ever_lived_together:
      parties_lived_at_vacate_address = False 
    if married_to_opposing_party and not ever_lived_together:
      cannot_complete_interview
    if married_to_opposing_party and not parties_lived_at_vacate_address:
      cannot_complete_interview
  if person_in_danger.all_false():
    cannot_complete_interview
  if current_case == False:
    cannot_complete_interview
  if married_to_opposing_party:
    if case_type_married == "other":
      cannot_complete_interview
    qualifying_209C = DAEmpty()
  else:
    if qualifying_209C == False:
      case_type_married = DAEmpty()
      cannot_complete_interview
  if parties_live_together_now == False and parties_lived_at_vacate_address:
    last_lived_together_date
  if married_to_opposing_party:
    docket_number.target_number = 1
    marriage_date
  if joint_children:
    joint_children_number
    if parties_live_together_now == False:
      children_live_with_one_party
  else: 
    joint_children_number = DAEmpty()
  user_has_additional_children
  emergency
  affidavit_warning
  if who_lives_at_vacate_address['opposing party'] and not who_lives_at_vacate_address['user']:
    reasons_for_leaving 
    if user_living_situation_unsafe:
      reason_living_situation_unsafe # do you want to tell
  reasons_for_danger
  if who_lives_at_vacate_address['opposing party']:
    other_parties[0].address = vacate_address 
  if not who_lives_at_vacate_address['opposing party']:
    other_parties[0].address
  if who_lives_at_vacate_address['user']:
    users[0].address = vacate_address
  else:
    users[0].address.address
  affidavit_reviewed
  if who_lives_at_vacate_address.all_true():
    domestic_violence_shelter = False
    phone_number_secret = False
    address_is_impounded = False
  else:
    domestic_violence_shelter
  users[0].address.geolocate()    
  trial_court.address.county
  who_filed_case
  docket_number.target_number
  docket_number.gather()
  other_parties[0].has_counsel
  other_parties[0].address
  users[0].email
  date  
  if not emergency and ready_to_serve:
    service_date
    service_method
  preview_screen
  users[0].states_above_true  
  basic_questions_signature_flow
  users[0].signature
  download
---
question: |
  Serving ${ other_parties.familiar() }
subquestion: |
  You need to give a copy of this form to ${ other_parties.familiar() }.
  This is called *service*.
  
  The court may be able to help you serve ${ other_parties.familiar() }
  because of the Covid-19 emergency. You can call them to find out more.
  
  Do you know when you will give a copy of this form to ${ other_parties.familiar() } ?
yesno: ready_to_serve
---
id: service
question: |
  Service on ${other_parties}
fields:
  - When will you serve ${other_parties.familiar()}?: service_date
    datatype: date
  - How will you serve them?: service_method
    datatype: radio
    choices:
      - By email: electronic mail
      - By mail (with postage paid by me): first class mail, postage prepaid
      - other: other
  - Other method: service_method
    show if:
      variable: service_method
      is: other

---
code: |
  users.there_is_another = False 
---
code: | 
  if cannot_complete_interview == 'exit':
    command('exit')
  elif cannot_complete_interview == 'restart': 
      command('restart')
---
code: |
  if who_lives_at_vacate_address['user']:
    users[0].address = vacate_address
  if who_lives_at_vacate_address['opposing party']:
    other_parties[0].address = vacate_address
---
code: | #change in the docx
  if domestic_violence_shelter or address_is_impounded:
    address_secret = True
  else:
    address_secret = False
    phone_number_secret = False
---
id: pleadingtitle
code: | #pleadingtitle
    pleading_title = 'Motion to Vacate Home'
---
code:  | 
  if who_filed_case == "User Filed":
    plaintiff = users
    defendant = other_parties[0]
    user_role = 'Plaintiff'
    opposing_party_role = 'Defendant'
  else:
    plaintiff = other_parties[0]
    defendant = users
    user_role = 'Defendant'
    opposing_party_role = 'Plaintiff'
---
code: |  
  if joint_children == False and user_has_additional_children == False:
    total_child_or_children = 0
  if user_has_additional_children == False:
    user_lives_with_additional_children = False
    user_lives_with_additional_children_number = 0
  if user_lives_with_additional_children_number > 1:
    additional_child_or_children = "children"
    additional_live_or_lives = "live"
  elif user_lives_with_additional_children_number == 1:
    additional_child_or_children = "child"
    additional_live_or_lives = "lives"
  if joint_children_number > 1:
    joint_child_or_children = "children"
    joint_live_or_lives = "live"
  elif joint_children_number == 1:
    joint_child_or_children = "child"
    joint_live_or_lives = "lives"
  user_total_children = user_lives_with_additional_children_number + joint_children_number
  if user_total_children == 1:
    total_child_or_children = "child"
  elif user_total_children > 1: 
    total_child_or_children = "children"
---
code: | #doesuserhavechildren
  if joint_children == True or user_lives_with_additional_children == True:
    user_has_children = True
---
id: Motion to Vacate the Home intro
question: |
    Motion to Vacate the Home 
subquestion: |
   If you need the court to help protect you or your children from the other person in your family law case, answer the questions in this interview.  
   
   We will help you write a motion that asks the court to order the other person in your family law case to:

   * Move out of your home.
   * Stay away from your home. Or, 
   * Move out of your home **and** stay away from your home.
field: intro_screen_seen 
---
id: interview prerequisites
question: |
   Before we continue...
subquestion: |   
   Are all of these things true? 
   
   % if married_to_opposing_party: 
   * You already have a case against ${other_parties[0].familiar()} in the Probate and Family Court. 
   * You live with or you used to live with ${other_parties[0].familiar()}. 
   * You need ${other_parties[0].familiar()} to leave the address you currently live at together or the last address you lived at together. 
   * You need to file this motion to protect the health, safety, or welfare of you or your children.
   % else:
   * You already have a case against ${other_parties[0].familiar()} in the Probate and Family Court. 
   * You need ${other_parties[0].familiar()} to leave or stay away from your address.  
   * You need to file this motion to protect the health, safety, or welfare of you or your children.
   % endif

yesno: prerequisites

---
id: Affidavit warning
question: |
  Affidavit
subquestion: |
  Explain to the judge what has happened and why you need a court order to make  ${ other_parties[0].familiar() } move out or stay away from your home.
  
  The answers you give in this interview help you write an "affidavit."  An affidavit is a written statement that tells the judge your story.  It is your chance to tell the judge what has happened and why you need to file this motion. 
  
  It is important to answer all the questions in this interview truthfully. You will be signing your affidavit "{under oath}." 
field: affidavit_warning
terms:
  - under oath: |
      means you swear your answers are true, as far as you know.  
      The court can punish you if your answers are not true to the best of your knowledge.  
      The court cannot punish you if your answers are about things you saw, heard, or felt.  
      The court cannot punish you if you have good reason to believe that your answers are true. 
---
id: Signing under oath
question: |
  Signing under oath 
subquestion: |
  When you sign your name you are declaring, "{under penalty of perjury}” that what you put in your affidavit is {true to the best of your knowledge}.
  
  Do you swear under penalty of perjury that all your answers to the questions in this interview are true, to the best of your knowledge?
fields:
  - no label: users[0].states_above_true
    datatype: checkboxes
    minlength: 1
    choices:
      - I swear that my answers on this form are the truth under penalties of perjury.
    validation messages:
      minlength: |
        You cannot keep going unless you did your best to tell the truth.
terms:
  - under penalty of perjury: |
      means you swear your answers are true, as far as you know.  
         
      Swearing "under penalty of perjury" means the court can punish you if your answers are not true to the best of your knowledge.  
      
      The court cannot punish you if your answers are about things you saw, heard, or felt.  
      The court cannot punish you if you have good reason to believe that your answers are true.
  - true to the best of your knowledge: |
      Something is true "to the best of your knowledge" if you were there and saw, heard, or felt it.  
      Something is true to the best of your knowledge if you have good reason to believe it is true.
---
id: vacate address
question: |
  What is the address you need ${other_parties[0].familiar()} to stay away from?
subquestion: |
  % if married_to_opposing_party:
  This can be the address where you live with ${other_parties[0].familiar()} now, **or**
  where you last lived with ${other_parties[0].familiar()}. 
  % endif
fields:
  - Street Address: vacate_address.address
    address autocomplete: True 
  - Unit: vacate_address.unit
    required: false
  - City: vacate_address.city
  - State: vacate_address.state
  - Zip code: vacate_address.zip
---
id: contact information
question: |
  Contact information
subquestion: |
  Give the court at least one way to reach you:
fields:
  - Mobile number: users[0].mobile_number
    required: False
  - Other phone number: users[0].phone_number
    required: False
  - Email address: users[0].email    
    datatype: email
    required: False
  - Best way to reach you: users[0].other_contact_method
    input type: area
    required: False
    help: |
      If you do not have a phone number or email the court can use, provide
      specific contact instructions. For example, use a friend's phone number.
      But the friend must be someone you can trust to tell you the court is
      trying to reach you.
validation code: |
  if (not showifdef('users[0].phone_number') and \
      (not showifdef('users[0].mobile_number')) and \
      (not showifdef('users[0].email')) and \
      (not showifdef('users[0].other_contact_method'))):
    validation_error(word("You need to provide at least one contact method."))
help: |
  You _must_ provide contact information so the court can reach you.
  
  Some forms allow you to tell the court you need to keep your address, phone,
  and email confidential, so that only court staff can see this information. 
---
id: denizens at vacate address
question: 
  Who lives at ${vacate_address.on_one_line()} now?
fields:
  - Pick all that apply: who_lives_at_vacate_address
    datatype: checkboxes
    choices:
      - I live there: user
      - ${other_parties[0].familiar()} lives there.: opposing party

---
id: parties cohabit
question: #livingtogether
  Living With ${other_parties[0].familiar()}
fields:
  - Did you ever live with ${other_parties[0].familiar()}?: ever_lived_together
    datatype: yesnoradio
  - Is ${vacate_address.address} the last place you lived with ${other_parties[0].familiar()}?: parties_lived_at_vacate_address
    datatype: yesnoradio
    show if: ever_lived_together
---
id: whose safety will be protected
question: |
  Health, safety, or welfare
subquestion: Whose health, safety, or welfare will be protected by making  ${other_parties[0].familiar()}  leave ${vacate_address.address}?
fields: 
  - check all that apply: person_in_danger
    datatype: checkboxes
    choices:
      - Mine: user
      - My children: children
---
id: relationship
question: #relationship
  Your relationship to ${other_parties[0].familiar()}
fields:
  - Are you married to ${other_parties[0].familiar()}?: married_to_opposing_party
    datatype: yesnoradio
  - Do you have any children with ${other_parties[0].familiar()}?: joint_children
    datatype: yesnoradio
---
id: signature
question: Sign here
signature: users[0].signature
under: |
  ${users[0].name}
---
id: has cases
question:
  Current Cases
subquestion: 
  Do you currently have any Probate and Family Court cases against ${other_parties[0].familiar()}?
fields: 
  - no label: current_case
    datatype: yesnoradio
---
id: case type
question: |
  What type of case do you have in the Probate and Family Court?
fields:
  - What type of case do you have?: case_type_married
    choices:
      - Divorce: divorce
      - Separate Support: separate_support 
      - Annulment: annulment
      - Something else: other
---
id: qualifying 209c
question: | # wording - give options 
  Probate and Family Court Case
subquestion:
  Is your case about the paternity, custody, child support, or parenting time of your children with ${other_parties[0].familiar()}?
yesno: qualifying_209C
---
id: your name
question:
  What is your name?
fields:
  - First Name: users[0].name.first
  - Middle name: users[0].name.middle
    required: False
  - Last Name: users[0].name.last
  - Suffix: users[0].name.suffix
    code: name_suffix()
    required: False
---
id: your address
question:
  Your address
fields:
  - Street Address: users[0].address.address
    address autocomplete: True
  - Unit: users[0].address.unit
    required: false
  - City: users[0].address.city
  - State: users[0].address.state
    default: MA
    code: |
      states_list()
  - Zip Code: users[0].address.zip
---
id: contact info
question: |
  Your Contact Information 
fields: 
  - Email address: users[0].email
    datatype: email 
    required: false
  - Phone Number: users[0].phone_number # hide if secret 
---
id: impoundment
question: | #impoundment
  Keeping your information safe
subquestion: |
  Normally, ${other_parties[0].familiar()} will see your address and contact information.  
  
  If you live in a domestic violence shelter or the court has already allowed you to  "{impound}" your address, ${other_parties[0].familiar()} will **not** be able to see this information.  
  
fields: # fix this in the Docx
  - Do you live in a domestic violence shelter? : domestic_violence_shelter
    datatype: yesnoradio
  - Did the Court already grant a motion to impound your address in this case, so you can keep it secret? : address_is_impounded
    datatype: yesnoradio
  - Do you need your phone number to be kept secret as well?: phone_number_secret
    datatype: yesnoradio
    js show if: |
      val("address_is_impounded") || val("domestic_violence_shelter")
terms: 
  impound: |
    When the court impounds information they keep the information from ${ other_parties[0].familiar() } and people who are normally allowed to see it, like the police and court staff.
---
id: op name
question: | #opname
  Who should the court order to move out or stay away?
subquestion: |
  What is the name of the other person in your family law case?
fields: 
  - First Name: other_parties[0].name.first
  - Last Name: other_parties[0].name.last
---
id: last lived together date
question:  #datemovedout
  When did you last live with ${other_parties[0].familiar()}?
subquestion: 
  What was the last date that you and ${other_parties[0].familiar()} lived together at ${vacate_address.on_one_line()}?
fields:
  - I do not know the date.: date_unknown
    datatype: yesno
  - no label: last_lived_together_date
    datatype: date
    hide if: date_unknown
  - Approximate date: last_lived_together_date
    show if: date_unknown
---
comment: |
  Do we want people to contact P & F court, or get legal help? i.e. find legal aid?
  That is this a problem with filing or a problem with getting opposing party to move out/stay away?
id: add reasons cannot complete 
question:
  This interview is not for you
subquestion:
  Based on your answers to the previous questions, we cannot complete your interview. [BR] [BR] ${reason_cannot_complete} [BR] [BR] [Talk to a lawyer](https://masslegalhelp.org/find-legal-aid) if you need help protecting your family from ${ other_parties[0].familiar() }.
event: cannot_complete_interview
buttons:
  - Exit: exit
  - Restart: restart 
---
code:  | 
  if married_to_opposing_party == False and joint_children == False:
    reason_cannot_complete = "You said you are not married to " + other_parties[0].familiar() + " **and** you do not have any children with " + other_parties[0].familiar() + ". To file this motion you need to be  married to " + other_parties[0].familiar() + " or have a child with " + other_parties[0].familiar() + "." 
  elif not prerequisites:
    if married_to_opposing_party:
      reason_cannot_complete = "To file this motion all these things must be true:[BR] [BR] You already have a case against " + other_parties[0].familiar() + " in the Probate and Family Court.[BR] [BR] You live with or you used to live with " + other_parties[0].familiar() + ".[BR] [BR] You need " + other_parties[0].familiar() + " to leave the address you currently live at together or the last address you lived at together. And[BR] [BR] You need to file this motion to protect the health, safety, or welfare of you or your children.[BR] [BR]  You said they are not all true."
    else:
      reason_cannot_complete = "To file this motion all these things must be true.[BR] [BR]You already have a case against " + other_parties[0].familiar() + " in the Probate and Family Court.[BR] [BR]You need " + other_parties[0].familiar() + " to leave or stay away from your address. And[BR] [BR] You need to file this motion to protect the health, safety, or welfare of you or your children.[BR] [BR] You said they are not all true."
  elif who_lives_at_vacate_address.all_false():
    reason_cannot_complete = "You said that neither you nor " + other_parties[0].familiar() + " live at the address you want " + other_parties[0].familiar() + " to leave.  One of you must still live there to use this interview tool."
  elif married_to_opposing_party and not ever_lived_together:
    reason_cannot_complete = "You said that you and " + other_parties[0].familiar() + " have never lived together.  You can only use this interview to ask " + other_parties[0].familiar() + " to leave somewhere you have lived together."
  elif married_to_opposing_party and not parties_lived_at_vacate_address:
    reason_cannot_complete = "You said that " + vacate_address.address + " isn't the last place you and " + other_parties[0].familiar() + " lived together.  You can only use this interview to ask " + other_parties[0].familiar() + " to leave the last place you lived together."
  elif person_in_danger.all_false():
    reason_cannot_complete = "You said that you do not need " + other_parties[0].familiar() + " to leave in order to protect the health, safety, or welfare of you or your children.  You can only use this interview if you need to protect the health, safety, or welfare of you or your children." 
  elif current_case == False:
    reason_cannot_complete = "You said that you do not currently have a case against " + other_parties[0].familiar() + " in the Probate and Family Court.  You must file a 'complaint' to start your case before you can file a motion."
  elif case_type_married == 'other':
    reason_cannot_complete = "You said that your Probate and Family Court case is something other than a divorce, separate support, or annulment.  Since you are married to the other side, you can only file this type of motion in a divorce, separate support, or annulment." 
  elif qualifying_209C == False:
    reason_cannot_complete = "You said your case against " + other_parties[0].familiar() + " is not about paternity, custody, child support, or parenting time. Since you are not married to " + other_parties[0].familiar() + " this interview tool is only available for those types of cases."
  elif users[0].states_above_true == False:
    reason_cannot_complete = "You must swear that all of your answers in this interview were the truth under penalty of perjury." 
---
id: op address
question:  #opaddress
  Where does ${other_parties[0].familiar()} live?
fields:
  - Street address: other_parties[0].address.address
    address autocomplete: True
  - Unit: other_parties[0].address.unit
    required: false
  - City: other_parties[0].address.city
  - State: other_parties[0].address.state
    code: |
      states_list()
    default: MA
  - Zip Code: other_parties[0].address.zip
---
comment: |
  autocomplete address doesn't seem to be working
id: opposing counsel
question: | 
 Does ${other_parties[0].familiar()} have a lawyer?

fields:
  - no label: other_parties[0].has_counsel
    datatype: yesnoradio
  - note: |
      ### What is the lawyer's ...
    show if: other_parties[0].has_counsel
  - First name: opposing_counsel.name.first
    show if: other_parties[0].has_counsel 
  - Last name: opposing_counsel.name.last
    show if: other_parties[0].has_counsel
  - Law firm: opposing_counsel.firm
    required: False
    show if: other_parties[0].has_counsel
  - Street Address: opposing_counsel.address.address
    address autocomplete: True
    show if: other_parties[0].has_counsel 
  - Unit: opposing_counsel.address.unit
    required: false
    show if: other_parties[0].has_counsel
  - City: opposing_counsel.address.city
    show if: other_parties[0].has_counsel 
  - State: opposing_counsel.address.state
    default: MA
    code: |
      states_list()
    show if: other_parties[0].has_counsel 
  - Zip Code: opposing_counsel.address.zip
    show if: other_parties[0].has_counsel
---
id: case info
question: | #caseinfo
  Your case in Probate and Family Court
subquestion: |
  Tell us more about your case.
fields:
  - Who filed the case?: who_filed_case
    help: |
      If you filed the "complaint," you filed this case.  If ${other_parties[0].name.familiar()} filed the complaint, they filed the case.
    datatype: radio
    choices:
      - 'I filed this case.': User Filed
      - '${other_parties[0].name.full()} filed this case.': Opposing Party Filed
---
id: other case count
question: |
    How many cases against ${other_parties[0].familiar()} do you have in Probate and Family Court right now?
subquestion:
    Each child that you have a case about will have their own separate case.
fields:
    - How many separate cases do you have?: docket_number.target_number
      datatype: integer
      min: 1
--- 
id: docket number
question: |
  % if docket_number.target_number == 1:
  What is the docket number of your case against ${other_parties[0].familiar()} in Probate and Family Court?
  % else:
  What is the docket number of your ${ordinal(i)} case against ${other_parties[0].familiar()} in Probate and Family Court?
  % endif
subquestion: |
  Write the docket number the same way it appears on any paperwork 
  you already got about the existing case.
  For example: BR19D1234DR.
fields:
    - Docket number: docket_number[i]
---
id: marriage date
question: | #datemarried
  Date of marriage
subquestion: 
  When did you marry ${other_parties[0].familiar()}?
fields: 
  - Date: marriage_date
    datatype: date
---
id: how many children
question: | #howmanykids
  Children with ${other_parties[0].familiar()}
subquestion: 
  You said you have children with ${other_parties[0].familiar()}.  
fields:
  - How many?: joint_children_number
    datatype: integer
    min: 0
---
id: where do children live
question: |
  Who do your children with ${other_parties[0].familiar()} live with right now?
fields: 
  - Who do the children live with?: children_live_with_one_party
    choices:
      - Me: user
      - ${other_parties[0].familiar()}: opposing party
      - Other: other
  - Do you want to tell the judge who your children are living with?: include_children_living_situation
    datatype: yesnoradio
    show if: 
      variable: children_live_with_one_party
      is: "other"
  - Describe who your children are living with, using complete sentences: children_living_situation
    show if: include_children_living_situation
---
code: |
  if children_live_with_one_party == "user" or "opposing party":
    children_live_with_other = DAEmpty()
---
id: other children
question: | #otherkids
  Other children
subquestion:
  Tell us about any children you have that ${other_parties[0].familiar()} is not the parent of.
fields:
  - Do you have any children that ${other_parties[0].familiar()} is not the parent of?: user_has_additional_children
    datatype: yesnoradio
  - Do any of them live with you?: user_lives_with_additional_children
    datatype: yesnoradio
    show if:
      variable: user_has_additional_children
      is: True
  - How many live with you?: user_lives_with_additional_children_number
    datatype: integer
    min: 1
    show if: user_lives_with_additional_children
---
code: |
  if user_has_additional_children == False:
    user_lives_with_additional_children = DAEmpty()
    user_lives_with_additional_children_number = DAEmpty()
---
code: |
  if person_in_danger['user'] and not person_in_danger['children']:
    person_in_danger_affidavit = "My health, safety, or welfare is in danger if the court does not order " + other_parties[0].familiar() + " to leave the home."
  elif person_in_danger.all_true('user','children'):
    person_in_danger_affidavit = "My health, safety, or welfare of and that of my children is in danger if the court does not order " + other_parties[0].familiar() + " to leave the home."
  elif person_in_danger['children'] and not person_in_danger['user']:
    person_in_danger_affidavit = "The health, safety, or welfare of my children is in danger if if the court does not order " + other_parties[0].familiar() + " to leave the home."
---
code: | 
  if person_in_danger['user'] and not person_in_danger['children']:
    person_in_danger_motion = "their health, safety, or welfare"
  elif person_in_danger.all_true('user','children'):
    person_in_danger_motion = "the health, safety, or welfare of " + user_role + " and their children" 
  elif person_in_danger['children'] and not person_in_danger['user']:
    person_in_danger_motion = "the health, safety, and welfare of " + user_role + "'s children" 
---
id: why need to vacate
question: Why do you need ${other_parties[0].familiar()} to move out or stay away from your home?
subquestion: |
  This is your chance to tell all the reasons that you or your children are at risk if ${other_parties[0].familiar()} does not leave. 
  
     The judge in your case will want to know why you or your children are in danger from ${other_parties[0].familiar()} staying at or coming to your home. You can talk about things like physical or emotional abuse, property damage, substance use, or anything else that shows why you or your children are in danger from ${other_parties[0].familiar()}.  
     
     Try to be as specific as possible.  Include specific incidents whenever possible, including when and where they took place.
fields:
  - no label: reasons_for_danger
    input type: area
    rows: 10
---
id: why moved
question: 
  Why did you move out of your home?
Fields:
  - Do you want to tell the judge in your affidavit why you moved out of your home?: include_reasons_for_leaving
    datatype: yesnoradio
  - Finish this sentence. I left ${vacate_address.address} because...: reasons_for_leaving
    show if: include_reasons_for_leaving
---
code: |  
  if not include_reasons_for_leaving:
    reasons_for_leaving = DAEmpty()
  if not include_reason_living_situation_unsafe:
    reason_living_situation_unsafe = DAEmpty()
---
id: is unsafe
question: 
  Is your current living situation unsafe? 
yesno: user_living_situation_unsafe
---
id: why unsafe
question: 
  Why is your living situation unsafe?
fields:
  - Do you want to tell the judge in your affidavit why your living situation is unsafe?: include_reason_living_situation_unsafe
    datatype: yesnoradio
  - My current living situation is not safe because...: reason_living_situation_unsafe
    show if: include_reason_living_situation_unsafe
---
id: is this an emergency
question: |
  Is this an emergency?
subquestion: |
  If this is an emergency, you can ask the Court to order ${other_parties[0].familiar()} move out or stay away from ${vacate_address.on_one_line()} right away.  
  
  If this is not an emergency, the Court will schedule a hearing on this motion sometime in the future.  
fields:
  - Is this an emergency?: emergency
    datatype: yesnoradio 
---
id: signature date
question: 
  When do you plan to file this motion?
# subquestion: 
#  What date do you intend to file this paperwork?
fields:
  - Date: date
    datatype: date
    default: ${today().format("yyyy-MM-dd")}
---
id: affidavit review
question: 
  Affidavit Review
subquestion: |
  This is a rough draft of your affidavit.  You can make any changes or
  add any more information here that you want the judge to know. 
  
  Each paragraph below will be an item in a numbered list. You 
  can add a new paragraph by using the "Enter" key.
  
  Keep each separate paragraph short and focused on the facts of what
  happened and how it affected you. Remember, everything you put here 
  will be under oath. 
  
  I, ${users[0].name.full()}, swear {under penalty of perjury} the following facts are {true to the best of my knowledge}:
fields:
  - no label: affidavit_reviewed
    datatype: area
    rows: 10
    default: ${affidavit_draft}
terms:
  - under penalty of perjury: |
      means you swear that what you write is true, as far as you know.  
         
      Swearing "under penalty of perjury" means the court can punish you if what you write is not true to the best of your knowledge.  
      
      The court cannot punish you if you write about things you saw, heard, or felt.  
      The court cannot punish you if you have good reason to believe that what you write is true.
  - true to the best of my knowledge: |
      Something is true "to the best of your knowledge" if you were there and saw, heard, or felt it.  
      Something is true to the best of your knowledge if you have good reason to believe it is true.
---
template: affidavit_draft
content: |
  % if married_to_opposing_party:
  I married ${other_parties[0].name.full()} on ${marriage_date}.
  %  endif 
  % if joint_children:
  I have ${joint_children_number} ${joint_child_or_children} with ${other_parties[0].name.full()}.
  % endif
  % if user_lives_with_additional_children:
  I also have ${user_lives_with_additional_children_number} ${additional_child_or_children} from another relationship that ${additional_live_or_lives} with me. 
  % endif
  % if parties_live_together_now:
  ${other_parties[0].familiar()} and I live together at ${vacate_address.on_one_line()}.
  % elif parties_lived_at_vacate_address:
  ${other_parties[0].familiar()} and I last lived together on or about ${last_lived_together_date} at ${vacate_address.on_one_line()}.
  % else:
  I have never lived with ${other_parties[0].familiar()} but I need them to stay away from my home.
  % endif
  % if parties_lived_at_vacate_address and who_lives_at_vacate_address['user'] and not who_lives_at_vacate_address['opposing party']:
  I still live at ${vacate_address.line_one()}. ${other_parties[0].familiar()} has moved out  to  ${other_parties[0].address.on_one_line()}.  
  % elif parties_lived_at_vacate_address and who_lives_at_vacate_address['opposing party'] and not who_lives_at_vacate_address['user']:
  ${other_parties[0]} still lives at ${vacate_address.line_one()}.  
  % if include_reasons_for_leaving:
  I left ${vacate_address.on_one_line()} because ${reasons_for_leaving}. 
  % endif
  % if include_reason_living_situation_unsafe:
  My current living situation is not safe because ${reason_living_situation_unsafe}.
  % endif
  % endif
  % if joint_children and not parties_live_together_now and children_live_with_one_party == "user":
  Our ${joint_child_or_children}  ${joint_live_or_lives} with me right now.
  % elif joint_children and not parties_live_together_now and children_live_with_one_party == "opposing party":
  Our ${joint_child_or_children}  ${joint_live_or_lives} with ${other_parties[0].familiar()} right now.
  % elif joint_children and not parties_live_together_now and children_live_with_one_party == "other" and include_children_living_situation:
  ${children_living_situation} 
  % endif
  ${person_in_danger_affidavit}
  ${reasons_for_danger} 
---
id: review before signature
continue button field: preview_screen
question: |
  Nearly finished
subquestion: |
  You are almost done! Tap the form below. It will open in a new window so you 
  can review it and make sure it is correct.
  
  Do not forget to come back to this page for the final step of signing and sending 
  the form to the court. 
  
   ${ motion_to_vacate_marital_home_attachment.as_pdf(key='preview') }

progress: 95
---
# if: not form_approved_for_email_filing
id: download form do not email
event: download
decoration: file-download
question: |
  Review, download, and file form
subquestion: |
  Your form is ready. You still need to call the court
  to figure out the best way to file it and to get a copy to ${ other_parties}.
    
  1. Click the preview image below to open the form in a new window.
  2. Download and save or print a copy of this form for your 
  records.
  3. Call the clerk of the ${ trial_court } at ${ trial_court.phone } or call the emergency help line
  at 833-912-6878 to get help filing this form. The clerk may ask you
  to email it, e-file it, or to print and mail it.
  
  ${ al_user_bundle.download_list_html() }
  
  ${ al_user_bundle.send_button_html() }
progress: 100
section: download  
---
# if: form_approved_for_email_filing
# event: download
# id: download form
# comment: |
#   The attachment email screen relies on final_form_to_file being defined. This
#   will be built from the interview_metadata dictionary's contents, but if you
#   add any addenda you will want to set this in a code block somewhere that takes
#   priority over basic-questions.yml.
# 
#   Cut "1. Correct any errors using the "Make changes" button below." because there is no make changes button.(CaroRob)
# decoration: file-download
# question: |
#   % if not defined('email_success') or not email_success:
#   Review, download, and send Form
#   % else:
#   Form delivered
#   % endif
# subquestion: |
#   % if not defined('email_success') or not email_success:
#   Thank you ${users[0]}. Your form is ready to send to the court. **It is not
#   delivered until you complete the delivery process.**
# 
#   1. Tap the preview image below to open the form in a new window. 
#   1. Download, and save or print a copy of this form for your 
#   records.
#   1. Click the "Submit to ${courts[0]}" button to send it to the court. 
#   1. You will have a chance to add instructions to the clerk and see the cover page before final delivery.
#   % else:
#   If you do not hear from the court in 1 business day, call the Trial Court’s
#   Emergency HelpLine 833-91-COURT (833-912-6878).
#   
#   The Emergency HelpLine is open:  
#   8:30am - 4:30pm,   
#   Monday - Friday.
#   % endif
#   
#   ${ form_to_file_no_cover }  
#   
#   % if not defined('email_success') or not email_success:
#     ${ action_button_html( url_action('form_delivery_complete'), id_tag="submitToCourt", label="Submit to " + str(courts[0].name), icon=send_icon, size="md", color="primary")}
#     
#   Download or email below:
#   % else:
#     Your email has already been delivered to ${courts[0]}
#     
#   [:file-download: Download with cover page](${final_form_to_file.url_for()})    
#   % endif
# progress: 100
# attachment code: attachments['final']
# section: download
---
code: |
  package_title = "Motion to Vacate Marital Home"
---
objects:
  - motion_to_vacate_marital_home_attachment: ALDocument.using(title="Motion to Vacate Marital Home", filename="motion_to_vacate", enabled=True)
---
objects:
  - al_user_bundle: ALDocumentBundle.using(title="Motion to Vacate Marital Home", filename="motion_to_vacate", enabled=True, elements=[motion_to_vacate_marital_home_attachment])
  - al_court_bundle: ALDocumentBundle.using(title="Motion to Vacate Marital Home", filename="motion_to_vacate", enabled=True, elements=[motion_to_vacate_marital_home_attachment])  
---
attachment:
  - name: Motion to Vacate Marital Home
    variable name: motion_to_vacate_marital_home_attachment[i] # preview or final
    filename: Motion_to_Vacate_Marital_Home
    docx template file: Motion_to_Vacate_Marital_Home.docx